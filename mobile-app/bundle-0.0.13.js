!function(){var t,e,n,i,r,o={};!function(){var o,s,a=document.createElement("div"),l={animation:["animationend","animationDuration","animationDelay","animationIterationCount","animation"],MozAnimation:["animationend","mozAnimationDuration","mozAnimationDelay","mozAnimationIterationCount","mozAnimation"],WebkitAnimation:["webkitAnimationEnd","webkitAnimationDuration","webkitAnimationDelay","webkitAnimationIterationCount","webkitAnimation"]};for(o in l)if(l.hasOwnProperty(o)&&void 0!==a.style[o])return s=l[o],t=s[0],e=s[1],n=s[2],i=s[3],void(r=s[4])}();var s=!1;function a(o,a,l,c){"function"==typeof l?(c=l,l={}):l||(l={}),s?c&&c():(l.delay&&(o.style[n]=l.delay),l.duration&&(o.style[e]=l.duration),l.iterationCount&&(o.style[i]=l.iterationCount),o.classList.add("animated"),o.classList.add(a),o.addEventListener(t,function e(){o.removeEventListener(t,e),o.classList.remove("animated"),o.classList.remove(a),(l.delay||l.duration||l.iterationCount)&&(o.style[r]=""),c&&c()}))}a.disable=function(){s=!0},o=a;var l={show:function(t){var e=0;t.forEach(function(t){o(t,"bounceInUp",{delay:e+"s"}),e+=.2})},hide:function(t,e){if(t.length){var n=0;t.reverse().forEach(function(i,r){o(i,"bounceOutDown",{delay:n+"s"},r===t.length-1?e:function(){i.style.display="none"}),n+=.2})}else e()}},c=function(t){if("string"!=typeof t)throw new TypeError("String expected");var e=/<([\w:]+)/.exec(t);if(!e)throw new Error("No elements were generated.");var n=e[1];if("body"==n){var i=document.createElement("html");return i.innerHTML=t,[i.removeChild(i.lastChild)]}var r=u[n]||u._default,o=r[0],s=r[1],a=r[2];for((i=document.createElement("div")).innerHTML=s+t+a;o--;)i=i.lastChild;return function(t){for(var e=[];t.length;)e.push(t[0].parentNode.removeChild(t[0]));return e}(i.children)},u={option:[1,'<select multiple="multiple">',"</select>"],optgroup:[1,'<select multiple="multiple">',"</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tbody:[1,"<table>","</table>"],tfoot:[1,"<table>","</table>"],colgroup:[1,"<table>","</table>"],caption:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],th:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:[0,"",""]},h=p,d=null;function p(t,e){e||(e={});var n="object"==typeof t?[t]:c(t);return d||(d=document.createElement("div")),g(m(e),function(t){var i=e[t];g(n,function(e){var n=e.parentNode;if(":first"===t)f(e,i);else if(/:first$/.test(t)){var r=t.replace(/:first$/,"");n&&n.removeChild(e),d.appendChild(e);var o=d.querySelector(r);d.removeChild(e),n&&n.appendChild(e),o&&f(o,i)}else{n&&n.removeChild(e),d.appendChild(e);var s=e.parentNode.querySelectorAll(t);if(d.removeChild(e),n&&n.appendChild(e),0===s.length)return;for(var a=0;a<s.length;a++)f(s[a],i)}})}),1===n.length?n[0]:n}function f(t,e){if(v(e))t.innerHTML="",t.appendChild(e);else if(y(e)){for(var n=0;n<e.length;n++){var i=p(t.cloneNode(!0),e[n]);t.parentNode.insertBefore(i,t)}t.parentNode.removeChild(t)}else e&&"object"==typeof e?g(m(e),function(n){if("_text"===n)b(t,e[n]);else if("_html"===n&&v(e[n]))t.innerHTML="",t.appendChild(e[n]);else if("_html"===n)t.innerHTML=e[n];else if(e[n]&&"object"==typeof e[n]){var i=e[n];i.append?t.setAttribute(n,t.getAttribute(n)+i.append):i.prepend&&t.setAttribute(n,i.prepend+t.getAttribute(n))}else t.setAttribute(n,e[n])}):b(t,e)}function g(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n)}var m=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};function v(t){return t&&"object"==typeof t&&t.childNodes&&("function"==typeof t.appendChild||"object"==typeof t.appendChild)}var y=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function b(t,e){t.innerHTML="";var n=document.createTextNode(String(e));t.appendChild(n)}var x={};x.create=function(t,e,n){var i=h('<div class="screen">\n  <div class="text">\n    <h2>Continue last story?</h2>\n    <p>Do you want to continue playing the last story?</p>\n  </div>\n  <div class="footer">\n    <button class="continue">Continue</button>\n    <button class="discard">Discard</button>\n  </div>\n</div>\n',{});t.appendChild(i);var r=i.querySelector(".footer"),o=[i.querySelector(".text"),r];r.querySelector(".continue").onclick=function(){l.hide(o,e)},r.querySelector(".discard").onclick=function(){l.hide(o,n)},l.show(o)};var w={exports:{}};(function(t){!function(t){"use strict";var e={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:f,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:f,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:f,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,paragraph:/^([^\n]+(?:\n?(?!hr|heading|lheading| {0,3}>|tag)[^\n]+)+)/,text:/^[^\n]+/};function n(t){this.tokens=[],this.tokens.links={},this.options=t||m.defaults,this.rules=e.normal,this.options.gfm&&(this.options.tables?this.rules=e.tables:this.rules=e.gfm)}e._label=/(?:\\[\[\]]|[^\[\]])+/,e._title=/(?:"(?:\\"|[^"]|"[^"\n]*")*"|'\n?(?:[^'\n]+\n?)*'|\([^()]*\))/,e.def=u(e.def).replace("label",e._label).replace("title",e._title).getRegex(),e.bullet=/(?:[*+-]|\d+\.)/,e.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,e.item=u(e.item,"gm").replace(/bull/g,e.bullet).getRegex(),e.list=u(e.list).replace(/bull/g,e.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+e.def.source+")").getRegex(),e._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b",e.html=u(e.html).replace("comment",/<!--[\s\S]*?-->/).replace("closed",/<(tag)[\s\S]+?<\/\1>/).replace("closing",/<tag(?:"[^"]*"|'[^']*'|\s[^'"\/>\s]*)*?\/?>/).replace(/tag/g,e._tag).getRegex(),e.paragraph=u(e.paragraph).replace("hr",e.hr).replace("heading",e.heading).replace("lheading",e.lheading).replace("tag","<"+e._tag).getRegex(),e.blockquote=u(e.blockquote).replace("paragraph",e.paragraph).getRegex(),e.normal=g({},e),e.gfm=g({},e.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\n? *\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),e.gfm.paragraph=u(e.paragraph).replace("(?!","(?!"+e.gfm.fences.source.replace("\\1","\\2")+"|"+e.list.source.replace("\\1","\\3")+"|").getRegex(),e.tables=g({},e.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),n.rules=e,n.lex=function(t,e){return new n(e).lex(t)},n.prototype.lex=function(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(t,!0)},n.prototype.token=function(t,n){var i,r,o,s,a,l,c,u,h,d,p;for(t=t.replace(/^ +$/gm,"");t;)if((o=this.rules.newline.exec(t))&&(t=t.substring(o[0].length),o[0].length>1&&this.tokens.push({type:"space"})),o=this.rules.code.exec(t))t=t.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?o:o.replace(/\n+$/,"")});else if(o=this.rules.fences.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"code",lang:o[2],text:o[3]||""});else if(o=this.rules.heading.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"heading",depth:o[1].length,text:o[2]});else if(n&&(o=this.rules.nptable.exec(t))){for(t=t.substring(o[0].length),l={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/\n$/,"").split("\n")},u=0;u<l.align.length;u++)/^ *-+: *$/.test(l.align[u])?l.align[u]="right":/^ *:-+: *$/.test(l.align[u])?l.align[u]="center":/^ *:-+ *$/.test(l.align[u])?l.align[u]="left":l.align[u]=null;for(u=0;u<l.cells.length;u++)l.cells[u]=l.cells[u].split(/ *\| */);this.tokens.push(l)}else if(o=this.rules.hr.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"hr"});else if(o=this.rules.blockquote.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),this.token(o,n),this.tokens.push({type:"blockquote_end"});else if(o=this.rules.list.exec(t)){for(t=t.substring(o[0].length),p=(s=o[2]).length>1,this.tokens.push({type:"list_start",ordered:p,start:p?+s:""}),i=!1,d=(o=o[0].match(this.rules.item)).length,u=0;u<d;u++)c=(l=o[u]).length,~(l=l.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(c-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+c+"}","gm"),"")),this.options.smartLists&&u!==d-1&&(s===(a=e.bullet.exec(o[u+1])[0])||s.length>1&&a.length>1||(t=o.slice(u+1).join("\n")+t,u=d-1)),r=i||/\n\n(?!\s*$)/.test(l),u!==d-1&&(i="\n"===l.charAt(l.length-1),r||(r=i)),this.tokens.push({type:r?"loose_item_start":"list_item_start"}),this.token(l,!1),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(o=this.rules.html.exec(t))t=t.substring(o[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===o[1]||"script"===o[1]||"style"===o[1]),text:o[0]});else if(n&&(o=this.rules.def.exec(t)))t=t.substring(o[0].length),o[3]&&(o[3]=o[3].substring(1,o[3].length-1)),h=o[1].toLowerCase(),this.tokens.links[h]||(this.tokens.links[h]={href:o[2],title:o[3]});else if(n&&(o=this.rules.table.exec(t))){for(t=t.substring(o[0].length),l={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/(?: *\| *)?\n$/,"").split("\n")},u=0;u<l.align.length;u++)/^ *-+: *$/.test(l.align[u])?l.align[u]="right":/^ *:-+: *$/.test(l.align[u])?l.align[u]="center":/^ *:-+ *$/.test(l.align[u])?l.align[u]="left":l.align[u]=null;for(u=0;u<l.cells.length;u++)l.cells[u]=l.cells[u].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(o=this.rules.lheading.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"heading",depth:"="===o[2]?1:2,text:o[1]});else if(n&&(o=this.rules.paragraph.exec(t)))t=t.substring(o[0].length),this.tokens.push({type:"paragraph",text:"\n"===o[1].charAt(o[1].length-1)?o[1].slice(0,-1):o[1]});else if(o=this.rules.text.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"text",text:o[0]});else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0));return this.tokens};var i={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:f,tag:/^<!--[\s\S]*?-->|^<\/?[a-zA-Z0-9\-]+(?:"[^"]*"|'[^']*'|\s[^<'">\/\s]*)*?\/?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^_([^\s_](?:[^_]|__)+?[^\s_])_\b|^\*((?:\*\*|[^*])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`]?)\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:f,text:/^[\s\S]+?(?=[\\<!\[`*]|\b_| {2,}\n|$)/};function r(t,e){if(this.options=e||m.defaults,this.links=t,this.rules=i.normal,this.renderer=this.options.renderer||new o,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=i.breaks:this.rules=i.gfm:this.options.pedantic&&(this.rules=i.pedantic)}function o(t){this.options=t||{}}function s(){}function a(t){this.tokens=[],this.token=null,this.options=t||m.defaults,this.options.renderer=this.options.renderer||new o,this.renderer=this.options.renderer,this.renderer.options=this.options}function l(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(t){return t.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(t,e){return"colon"===(e=e.toLowerCase())?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""})}function u(t,e){return t=t.source,e=e||"",{replace:function(e,n){return n=(n=n.source||n).replace(/(^|[^\[])\^/g,"$1"),t=t.replace(e,n),this},getRegex:function(){return new RegExp(t,e)}}}function h(t,e){return d[" "+t]||(/^[^:]+:\/*[^/]*$/.test(t)?d[" "+t]=t+"/":d[" "+t]=t.replace(/[^/]*$/,"")),t=d[" "+t],"//"===e.slice(0,2)?t.replace(/:[\s\S]*/,":")+e:"/"===e.charAt(0)?t.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+e:t+e}i._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,i._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,i.autolink=u(i.autolink).replace("scheme",i._scheme).replace("email",i._email).getRegex(),i._inside=/(?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]]|\](?=[^\[]*\]))*/,i._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,i.link=u(i.link).replace("inside",i._inside).replace("href",i._href).getRegex(),i.reflink=u(i.reflink).replace("inside",i._inside).getRegex(),i.normal=g({},i),i.pedantic=g({},i.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),i.gfm=g({},i.normal,{escape:u(i.escape).replace("])","~|])").getRegex(),url:u(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("email",i._email).getRegex(),_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:u(i.text).replace("]|","~]|").replace("|","|https?://|ftp://|www\\.|[a-zA-Z0-9.!#$%&'*+/=?^_`{\\|}~-]+@|").getRegex()}),i.breaks=g({},i.gfm,{br:u(i.br).replace("{2,}","*").getRegex(),text:u(i.gfm.text).replace("{2,}","*").getRegex()}),r.rules=i,r.output=function(t,e,n){return new r(e,n).output(t)},r.prototype.output=function(t){for(var e,n,i,r,o="";t;)if(r=this.rules.escape.exec(t))t=t.substring(r[0].length),o+=r[1];else if(r=this.rules.autolink.exec(t))t=t.substring(r[0].length),i="@"===r[2]?"mailto:"+(n=l(this.mangle(r[1]))):n=l(r[1]),o+=this.renderer.link(i,null,n);else if(this.inLink||!(r=this.rules.url.exec(t))){if(r=this.rules.tag.exec(t))!this.inLink&&/^<a /i.test(r[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(r[0])&&(this.inLink=!1),t=t.substring(r[0].length),o+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):l(r[0]):r[0];else if(r=this.rules.link.exec(t))t=t.substring(r[0].length),this.inLink=!0,o+=this.outputLink(r,{href:r[2],title:r[3]}),this.inLink=!1;else if((r=this.rules.reflink.exec(t))||(r=this.rules.nolink.exec(t))){if(t=t.substring(r[0].length),e=(r[2]||r[1]).replace(/\s+/g," "),!(e=this.links[e.toLowerCase()])||!e.href){o+=r[0].charAt(0),t=r[0].substring(1)+t;continue}this.inLink=!0,o+=this.outputLink(r,e),this.inLink=!1}else if(r=this.rules.strong.exec(t))t=t.substring(r[0].length),o+=this.renderer.strong(this.output(r[2]||r[1]));else if(r=this.rules.em.exec(t))t=t.substring(r[0].length),o+=this.renderer.em(this.output(r[2]||r[1]));else if(r=this.rules.code.exec(t))t=t.substring(r[0].length),o+=this.renderer.codespan(l(r[2].trim(),!0));else if(r=this.rules.br.exec(t))t=t.substring(r[0].length),o+=this.renderer.br();else if(r=this.rules.del.exec(t))t=t.substring(r[0].length),o+=this.renderer.del(this.output(r[1]));else if(r=this.rules.text.exec(t))t=t.substring(r[0].length),o+=this.renderer.text(l(this.smartypants(r[0])));else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0))}else r[0]=this.rules._backpedal.exec(r[0])[0],t=t.substring(r[0].length),"@"===r[2]?i="mailto:"+(n=l(r[0])):(n=l(r[0]),i="www."===r[1]?"http://"+n:n),o+=this.renderer.link(i,null,n);return o},r.prototype.outputLink=function(t,e){var n=l(e.href),i=e.title?l(e.title):null;return"!"!==t[0].charAt(0)?this.renderer.link(n,i,this.output(t[1])):this.renderer.image(n,i,l(t[1]))},r.prototype.smartypants=function(t){return this.options.smartypants?t.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026"):t},r.prototype.mangle=function(t){if(!this.options.mangle)return t;for(var e,n="",i=t.length,r=0;r<i;r++)e=t.charCodeAt(r),Math.random()>.5&&(e="x"+e.toString(16)),n+="&#"+e+";";return n},o.prototype.code=function(t,e,n){if(this.options.highlight){var i=this.options.highlight(t,e);null!=i&&i!==t&&(n=!0,t=i)}return e?'<pre><code class="'+this.options.langPrefix+l(e,!0)+'">'+(n?t:l(t,!0))+"\n</code></pre>\n":"<pre><code>"+(n?t:l(t,!0))+"\n</code></pre>"},o.prototype.blockquote=function(t){return"<blockquote>\n"+t+"</blockquote>\n"},o.prototype.html=function(t){return t},o.prototype.heading=function(t,e,n){return"<h"+e+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+t+"</h"+e+">\n"},o.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},o.prototype.list=function(t,e,n){var i=e?"ol":"ul";return"<"+i+(e&&1!==n?' start="'+n+'"':"")+">\n"+t+"</"+i+">\n"},o.prototype.listitem=function(t){return"<li>"+t+"</li>\n"},o.prototype.paragraph=function(t){return"<p>"+t+"</p>\n"},o.prototype.table=function(t,e){return"<table>\n<thead>\n"+t+"</thead>\n<tbody>\n"+e+"</tbody>\n</table>\n"},o.prototype.tablerow=function(t){return"<tr>\n"+t+"</tr>\n"},o.prototype.tablecell=function(t,e){var n=e.header?"th":"td";return(e.align?"<"+n+' style="text-align:'+e.align+'">':"<"+n+">")+t+"</"+n+">\n"},o.prototype.strong=function(t){return"<strong>"+t+"</strong>"},o.prototype.em=function(t){return"<em>"+t+"</em>"},o.prototype.codespan=function(t){return"<code>"+t+"</code>"},o.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},o.prototype.del=function(t){return"<del>"+t+"</del>"},o.prototype.link=function(t,e,n){if(this.options.sanitize){try{var i=decodeURIComponent(c(t)).replace(/[^\w:]/g,"").toLowerCase()}catch(t){return n}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:")||0===i.indexOf("data:"))return n}this.options.baseUrl&&!p.test(t)&&(t=h(this.options.baseUrl,t));var r='<a href="'+t+'"';return e&&(r+=' title="'+e+'"'),r+">"+n+"</a>"},o.prototype.image=function(t,e,n){this.options.baseUrl&&!p.test(t)&&(t=h(this.options.baseUrl,t));var i='<img src="'+t+'" alt="'+n+'"';return e&&(i+=' title="'+e+'"'),i+(this.options.xhtml?"/>":">")},o.prototype.text=function(t){return t},s.prototype.strong=s.prototype.em=s.prototype.codespan=s.prototype.del=s.prototype.text=function(t){return t},s.prototype.link=s.prototype.image=function(t,e,n){return""+n},s.prototype.br=function(){return""},a.parse=function(t,e){return new a(e).parse(t)},a.prototype.parse=function(t){this.inline=new r(t.links,this.options),this.inlineText=new r(t.links,g({},this.options,{renderer:new s})),this.tokens=t.reverse();for(var e="";this.next();)e+=this.tok();return e},a.prototype.next=function(){return this.token=this.tokens.pop()},a.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},a.prototype.parseText=function(){for(var t=this.token.text;"text"===this.peek().type;)t+="\n"+this.next().text;return this.inline.output(t)},a.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,c(this.inlineText.output(this.token.text)));case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var t,e,n,i,r="",o="";for(n="",t=0;t<this.token.header.length;t++)n+=this.renderer.tablecell(this.inline.output(this.token.header[t]),{header:!0,align:this.token.align[t]});for(r+=this.renderer.tablerow(n),t=0;t<this.token.cells.length;t++){for(e=this.token.cells[t],n="",i=0;i<e.length;i++)n+=this.renderer.tablecell(this.inline.output(e[i]),{header:!1,align:this.token.align[i]});o+=this.renderer.tablerow(n)}return this.renderer.table(r,o);case"blockquote_start":for(o="";"blockquote_end"!==this.next().type;)o+=this.tok();return this.renderer.blockquote(o);case"list_start":o="";for(var s=this.token.ordered,a=this.token.start;"list_end"!==this.next().type;)o+=this.tok();return this.renderer.list(o,s,a);case"list_item_start":for(o="";"list_item_end"!==this.next().type;)o+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(o);case"loose_item_start":for(o="";"list_item_end"!==this.next().type;)o+=this.tok();return this.renderer.listitem(o);case"html":var l=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(l);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}};var d={},p=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function f(){}function g(t){for(var e,n,i=1;i<arguments.length;i++)for(n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function m(t,e,i){if(void 0===t||null===t)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof t)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected");if(i||"function"==typeof e){i||(i=e,e=null);var r,o,s=(e=g({},m.defaults,e||{})).highlight,c=0;try{r=n.lex(t,e)}catch(t){return i(t)}o=r.length;var u=function(t){if(t)return e.highlight=s,i(t);var n;try{n=a.parse(r,e)}catch(e){t=e}return e.highlight=s,t?i(t):i(null,n)};if(!s||s.length<3)return u();if(delete e.highlight,!o)return u();for(;c<r.length;c++)!function(t){"code"!==t.type?--o||u():s(t.text,t.lang,function(e,n){return e?u(e):null==n||n===t.text?--o||u():(t.text=n,t.escaped=!0,void(--o||u()))})}(r[c])}else try{return e&&(e=g({},m.defaults,e)),a.parse(n.lex(t,e),e)}catch(t){if(t.message+="\nPlease report this to https://github.com/markedjs/marked.",(e||m.defaults).silent)return"<p>An error occurred:</p><pre>"+l(t.message+"",!0)+"</pre>";throw t}}f.exec=f,m.options=m.setOptions=function(t){return g(m.defaults,t),m},m.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new o,xhtml:!1,baseUrl:null},m.Parser=a,m.parser=a.parse,m.Renderer=o,m.TextRenderer=s,m.Lexer=n,m.lexer=n.lex,m.InlineLexer=r,m.inlineLexer=r.output,m.parse=m,"object"==typeof w.exports?w.exports=m:"function"==typeof define&&define.amd?define(function(){return m}):t.marked=m}(this||("undefined"!=typeof window?window:t))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),w=w.exports;var k={};k.create=function(t,e,n){var i=h('<div class="screen">\n  <div class="text"></div>\n  <div class="footer">\n    <button class="next">&#8594;</button>\n  </div>\n</div>\n',{".text":{_html:w(e)}}),r=i.querySelector(".footer"),o=[i.querySelector(".text")];n?(o.push(r),r.querySelector(".next").onclick=function(){l.hide(o,n)}):r.style.display="none",t.appendChild(i),l.show(o)};var L={exports:{}};!function(t,e){"use strict";function n(){}n.TO_RAD=Math.PI/180,n.TO_DEG=180/Math.PI,n.PI_X2=2*Math.PI,n.PI_DIV4=Math.PI/4;var i=Object.create(n.prototype,{version:{value:"2.0.23"},radius:{value:6378137},minLat:{value:-90},maxLat:{value:90},minLon:{value:-180},maxLon:{value:180},sexagesimalPattern:{value:/^([0-9]{1,3})\xb0\s*([0-9]{1,3}(?:\.(?:[0-9]{1,2}))?)'\s*(([0-9]{1,3}(\.([0-9]{1,4}))?)"\s*)?([NEOSW]?)$/},measures:{value:Object.create(Object.prototype,{m:{value:1},km:{value:.001},cm:{value:100},mm:{value:1e3},mi:{value:1/1609.344},sm:{value:1/1852.216},ft:{value:100/30.48},in:{value:100/2.54},yd:{value:1/.9144}})},prototype:{value:n.prototype},extend:{value:function(t,e){for(var n in t)void 0!==i.prototype[n]&&!0!==e||("function"==typeof t[n]&&"function"==typeof t[n].bind?i.prototype[n]=t[n].bind(i):i.prototype[n]=t[n])}}});void 0===Number.prototype.toRad&&(Number.prototype.toRad=function(){return this*n.TO_RAD}),void 0===Number.prototype.toDeg&&(Number.prototype.toDeg=function(){return this*n.TO_DEG}),i.extend({decimal:{},sexagesimal:{},distance:null,getKeys:function(t){if("[object Array]"==Object.prototype.toString.call(t))return{longitude:t.length>=1?0:void 0,latitude:t.length>=2?1:void 0,elevation:t.length>=3?2:void 0};var e=function(e){var n;return e.every(function(e){return"object"!=typeof t||!t.hasOwnProperty(e)||(n=e,!1)}),n},n=e(["lng","lon","longitude"]),i=e(["lat","latitude"]),r=e(["alt","altitude","elevation","elev"]);return void 0!==i||void 0!==n||void 0!==r?{latitude:i,longitude:n,elevation:r}:void 0},getLat:function(t,e){return!0===e?t[this.getKeys(t).latitude]:this.useDecimal(t[this.getKeys(t).latitude])},latitude:function(t){return this.getLat.call(this,t)},getLon:function(t,e){return!0===e?t[this.getKeys(t).longitude]:this.useDecimal(t[this.getKeys(t).longitude])},longitude:function(t){return this.getLon.call(this,t)},getElev:function(t){return t[this.getKeys(t).elevation]},elevation:function(t){return this.getElev.call(this,t)},coords:function(t,e){var n={latitude:!0===e?t[this.getKeys(t).latitude]:this.useDecimal(t[this.getKeys(t).latitude]),longitude:!0===e?t[this.getKeys(t).longitude]:this.useDecimal(t[this.getKeys(t).longitude])},i=t[this.getKeys(t).elevation];return void 0!==i&&(n.elevation=i),n},ll:function(t,e){return this.coords.call(this,t,e)},validate:function(t){var e=this.getKeys(t);if(void 0===e||void 0===e.latitude||"undefined"===e.longitude)return!1;var n=t[e.latitude],i=t[e.longitude];return!(void 0===n||!this.isDecimal(n)&&!this.isSexagesimal(n)||void 0===i||!this.isDecimal(i)&&!this.isSexagesimal(i)||(n=this.useDecimal(n),i=this.useDecimal(i),n<this.minLat||n>this.maxLat||i<this.minLon||i>this.maxLon))},getDistance:function(t,e,n,r){n=Math.floor(n)||1,r=Math.floor(r)||0;var o,s,a,l,c,u,h,d=this.coords(t),p=this.coords(e),f=6378137,g=6356752.314245,m=1/298.257223563,v=(p.longitude-d.longitude).toRad(),y=Math.atan((1-m)*Math.tan(parseFloat(d.latitude).toRad())),b=Math.atan((1-m)*Math.tan(parseFloat(p.latitude).toRad())),x=Math.sin(y),w=Math.cos(y),k=Math.sin(b),L=Math.cos(b),M=v,_=100;do{var S=Math.sin(M),E=Math.cos(M);if(0===(u=Math.sqrt(L*S*(L*S)+(w*k-x*L*E)*(w*k-x*L*E))))return i.distance=0;o=x*k+w*L*E,s=Math.atan2(u,o),c=o-2*x*k/(l=1-(a=w*L*S/u)*a),isNaN(c)&&(c=0);var C=m/16*l*(4+m*(4-3*l));h=M,M=v+(1-C)*m*a*(s+C*u*(c+C*o*(2*c*c-1)))}while(Math.abs(M-h)>1e-12&&--_>0);if(0===_)return NaN;var A=l*(f*f-g*g)/(g*g),D=A/1024*(256+A*(A*(74-47*A)-128)),T=g*(1+A/16384*(4096+A*(A*(320-175*A)-768)))*(s-D*u*(c+D/4*(o*(2*c*c-1)-D/6*c*(4*u*u-3)*(4*c*c-3))));if(T=T.toFixed(r),void 0!==this.elevation(t)&&void 0!==this.elevation(e)){var R=Math.abs(this.elevation(t)-this.elevation(e));T=Math.sqrt(T*T+R*R)}return this.distance=Math.round(T*Math.pow(10,r)/n)*n/Math.pow(10,r)},getDistanceSimple:function(t,e,n){n=Math.floor(n)||1;var r=Math.round(Math.acos(Math.sin(this.latitude(e).toRad())*Math.sin(this.latitude(t).toRad())+Math.cos(this.latitude(e).toRad())*Math.cos(this.latitude(t).toRad())*Math.cos(this.longitude(t).toRad()-this.longitude(e).toRad()))*this.radius);return i.distance=Math.floor(Math.round(r/n)*n)},getCenter:function(t){var e=t;if("object"==typeof t&&!(t instanceof Array))for(var i in e=[],t)e.push(this.coords(t[i]));if(!e.length)return!1;var r,o,s,a=0,l=0,c=0;e.forEach(function(t){r=this.latitude(t).toRad(),o=this.longitude(t).toRad(),a+=Math.cos(r)*Math.cos(o),l+=Math.cos(r)*Math.sin(o),c+=Math.sin(r)},this);var u=e.length;return a/=u,l/=u,c/=u,o=Math.atan2(l,a),s=Math.sqrt(a*a+l*l),{latitude:((r=Math.atan2(c,s))*n.TO_DEG).toFixed(6),longitude:(o*n.TO_DEG).toFixed(6)}},getBounds:function(t){if(!t.length)return!1;var e=this.elevation(t[0]),n={maxLat:-1/0,minLat:1/0,maxLng:-1/0,minLng:1/0};void 0!==e&&(n.maxElev=0,n.minElev=1/0);for(var i=0,r=t.length;i<r;++i)n.maxLat=Math.max(this.latitude(t[i]),n.maxLat),n.minLat=Math.min(this.latitude(t[i]),n.minLat),n.maxLng=Math.max(this.longitude(t[i]),n.maxLng),n.minLng=Math.min(this.longitude(t[i]),n.minLng),e&&(n.maxElev=Math.max(this.elevation(t[i]),n.maxElev),n.minElev=Math.min(this.elevation(t[i]),n.minElev));return n},getCenterOfBounds:function(t){var e=this.getBounds(t),n=e.minLat+(e.maxLat-e.minLat)/2,i=e.minLng+(e.maxLng-e.minLng)/2;return{latitude:parseFloat(n.toFixed(6)),longitude:parseFloat(i.toFixed(6))}},getBoundsOfDistance:function(t,e){var i,r,o=this.latitude(t),s=this.longitude(t),a=o.toRad(),l=s.toRad(),c=e/this.radius,u=a-c,h=a+c,d=this.maxLat.toRad(),p=this.minLat.toRad(),f=this.maxLon.toRad(),g=this.minLon.toRad();if(u>p&&h<d){var m=Math.asin(Math.sin(c)/Math.cos(a));(i=l-m)<g&&(i+=n.PI_X2),(r=l+m)>f&&(r-=n.PI_X2)}else u=Math.max(u,p),h=Math.min(h,d),i=g,r=f;return[{latitude:u.toDeg(),longitude:i.toDeg()},{latitude:h.toDeg(),longitude:r.toDeg()}]},isPointInside:function(t,e){for(var n=!1,i=-1,r=e.length,o=r-1;++i<r;o=i)(this.longitude(e[i])<=this.longitude(t)&&this.longitude(t)<this.longitude(e[o])||this.longitude(e[o])<=this.longitude(t)&&this.longitude(t)<this.longitude(e[i]))&&this.latitude(t)<(this.latitude(e[o])-this.latitude(e[i]))*(this.longitude(t)-this.longitude(e[i]))/(this.longitude(e[o])-this.longitude(e[i]))+this.latitude(e[i])&&(n=!n);return n},preparePolygonForIsPointInsideOptimized:function(t){for(var e=0,n=t.length-1;e<t.length;e++)this.longitude(t[n])===this.longitude(t[e])?(t[e].constant=this.latitude(t[e]),t[e].multiple=0):(t[e].constant=this.latitude(t[e])-this.longitude(t[e])*this.latitude(t[n])/(this.longitude(t[n])-this.longitude(t[e]))+this.longitude(t[e])*this.latitude(t[e])/(this.longitude(t[n])-this.longitude(t[e])),t[e].multiple=(this.latitude(t[n])-this.latitude(t[e]))/(this.longitude(t[n])-this.longitude(t[e]))),n=e},isPointInsideWithPreparedPolygon:function(t,e){for(var n=!1,i=this.longitude(t),r=this.latitude(t),o=0,s=e.length-1;o<e.length;o++)(this.longitude(e[o])<i&&this.longitude(e[s])>=i||this.longitude(e[s])<i&&this.longitude(e[o])>=i)&&(n^=i*e[o].multiple+e[o].constant<r),s=o;return n},isInside:function(){return this.isPointInside.apply(this,arguments)},isPointInCircle:function(t,e,n){return this.getDistance(t,e)<n},withinRadius:function(){return this.isPointInCircle.apply(this,arguments)},getRhumbLineBearing:function(t,e){var i=this.longitude(e).toRad()-this.longitude(t).toRad(),r=Math.log(Math.tan(this.latitude(e).toRad()/2+n.PI_DIV4)/Math.tan(this.latitude(t).toRad()/2+n.PI_DIV4));return Math.abs(i)>Math.PI&&(i=i>0?-1*(n.PI_X2-i):n.PI_X2+i),(Math.atan2(i,r).toDeg()+360)%360},getBearing:function(t,e){return e.latitude=this.latitude(e),e.longitude=this.longitude(e),t.latitude=this.latitude(t),t.longitude=this.longitude(t),(Math.atan2(Math.sin(e.longitude.toRad()-t.longitude.toRad())*Math.cos(e.latitude.toRad()),Math.cos(t.latitude.toRad())*Math.sin(e.latitude.toRad())-Math.sin(t.latitude.toRad())*Math.cos(e.latitude.toRad())*Math.cos(e.longitude.toRad()-t.longitude.toRad())).toDeg()+360)%360},getCompassDirection:function(t,e,n){var i,r;switch(r="circle"==n?this.getBearing(t,e):this.getRhumbLineBearing(t,e),Math.round(r/22.5)){case 1:i={exact:"NNE",rough:"N"};break;case 2:i={exact:"NE",rough:"N"};break;case 3:i={exact:"ENE",rough:"E"};break;case 4:i={exact:"E",rough:"E"};break;case 5:i={exact:"ESE",rough:"E"};break;case 6:i={exact:"SE",rough:"E"};break;case 7:i={exact:"SSE",rough:"S"};break;case 8:i={exact:"S",rough:"S"};break;case 9:i={exact:"SSW",rough:"S"};break;case 10:i={exact:"SW",rough:"S"};break;case 11:i={exact:"WSW",rough:"W"};break;case 12:i={exact:"W",rough:"W"};break;case 13:i={exact:"WNW",rough:"W"};break;case 14:i={exact:"NW",rough:"W"};break;case 15:i={exact:"NNW",rough:"N"};break;default:i={exact:"N",rough:"N"}}return i.bearing=r,i},getDirection:function(t,e,n){return this.getCompassDirection.apply(this,arguments)},orderByDistance:function(t,e){return Object.keys(e).map(function(n){var i=this.getDistance(t,e[n]),r=Object.create(e[n]);return r.distance=i,r.key=n,r},this).sort(function(t,e){return t.distance-e.distance})},isPointInLine:function(t,e,n){return(this.getDistance(e,t,1,3)+this.getDistance(t,n,1,3)).toFixed(3)==this.getDistance(e,n,1,3)},isPointNearLine:function(t,e,n,i){return this.getDistanceFromLine(t,e,n)<i},getDistanceFromLine:function(t,e,n){var i=this.getDistance(e,t,1,3),r=this.getDistance(t,n,1,3),o=this.getDistance(e,n,1,3),s=Math.acos((i*i+o*o-r*r)/(2*i*o)),a=Math.acos((r*r+o*o-i*i)/(2*r*o));return s>Math.PI/2?i:a>Math.PI/2?r:Math.sin(s)*i},findNearest:function(t,e,n,i){n=n||0,i=i||1;var r=this.orderByDistance(t,e);return 1===i?r[n]:r.splice(n,i)},getPathLength:function(t){for(var e,n=0,i=0,r=t.length;i<r;++i)e&&(n+=this.getDistance(this.coords(t[i]),e)),e=this.coords(t[i]);return n},getSpeed:function(t,e,n){var r=n&&n.unit||"km";"mph"==r?r="mi":"kmh"==r&&(r="km");var o=i.getDistance(t,e)/(1*e.time/1e3-1*t.time/1e3)*3600;return Math.round(o*this.measures[r]*1e4)/1e4},computeDestinationPoint:function(t,e,n,i){var r=this.latitude(t),o=this.longitude(t);i=void 0===i?this.radius:Number(i);var s=Number(e)/i,a=Number(n).toRad(),l=Number(r).toRad(),c=Number(o).toRad(),u=Math.asin(Math.sin(l)*Math.cos(s)+Math.cos(l)*Math.sin(s)*Math.cos(a)),h=c+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(l),Math.cos(s)-Math.sin(l)*Math.sin(u));return h=(h+3*Math.PI)%(2*Math.PI)-Math.PI,{latitude:u.toDeg(),longitude:h.toDeg()}},convertUnit:function(t,e,n){if(0===e)return 0;if(void 0===e){if(null===this.distance)throw new Error("No distance was given");if(0===this.distance)return 0;e=this.distance}if(t=t||"m",n=null==n?4:n,void 0!==this.measures[t])return this.round(e*this.measures[t],n);throw new Error("Unknown unit for conversion.")},useDecimal:function(t){if("[object Array]"===Object.prototype.toString.call(t)){var e=this;return t.map(function(t){if(e.isDecimal(t))return e.useDecimal(t);if("object"==typeof t){if(e.validate(t))return e.coords(t);for(var n in t)t[n]=e.useDecimal(t[n]);return t}return e.isSexagesimal(t)?e.sexagesimal2decimal(t):t})}if("object"==typeof t&&this.validate(t))return this.coords(t);if("object"==typeof t){for(var n in t)t[n]=this.useDecimal(t[n]);return t}if(this.isDecimal(t))return parseFloat(t);if(!0===this.isSexagesimal(t))return parseFloat(this.sexagesimal2decimal(t));throw new Error("Unknown format.")},decimal2sexagesimal:function(t){if(t in this.sexagesimal)return this.sexagesimal[t];var e=t.toString().split("."),n=Math.abs(e[0]),i=60*("0."+(e[1]||0)),r=i.toString().split(".");return i=Math.floor(i),r=(60*("0."+(r[1]||0))).toFixed(2),this.sexagesimal[t]=n+"\xb0 "+i+"' "+r+'"',this.sexagesimal[t]},sexagesimal2decimal:function(t){if(t in this.decimal)return this.decimal[t];var e=new RegExp(this.sexagesimalPattern).exec(t),n=0,i=0;e&&(n=parseFloat(e[2]/60),i=parseFloat(e[4]/3600)||0);var r=(parseFloat(e[1])+n+i).toFixed(8);return r="S"==e[7]||"W"==e[7]?parseFloat(-r):parseFloat(r),this.decimal[t]=r,r},isDecimal:function(t){return t=t.toString().replace(/\s*/,""),!isNaN(parseFloat(t))&&parseFloat(t)==t},isSexagesimal:function(t){return t=t.toString().replace(/\s*/,""),this.sexagesimalPattern.test(t)},round:function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}}),void 0!==L.exports?(L.exports=i,"object"==typeof t&&(t.geolib=i)):"function"==typeof define&&define.amd?define("geolib",[],function(){return i}):t.geolib=i}(this),L=L.exports;var M={};M="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t};var _={};function S(t){this.center=t}function E(t,e){S.call(this,t),this.radius=e}function C(t){S.call(this,L.getCenter(t)),this.coords=t}S.prototype.distance=function(t){return L.getDistance(this.center,t)},M(E,S),E.prototype.within=function(t){return this.distance(t)<=this.radius},M(C,S),C.prototype.within=function(t){return L.isPointInside(t,this.coords)},_.fromJson=function(t){if("circle"===t.type)return new E(t.center,t.radius);if("polygon"===t.type)return new C(t.coords);throw new Error("Unkown type: "+t.type)};var A={};A.create=function(t){var e=h('<div class="screen">\n  <div class="text"></div>\n  <form class="story" action="">\n    <input type="text" name="story" placeholder="Paste story URL here" autocomplete="off"/>\n  </form>\n</div>\n',{".text":{_html:w("## Location based stories\n\nGeo Tales lets you create and play interactive, location based stories.\n\nStories can be created by anybody and hosted for free on GitHub. Please see\nthe [Geo Tales project page][project] for details on how to build stories.\n\nTo play a story, enter the gist URL below, or check out the [screens tour][].\n\n[project]: https://github.com/geo-tales/geo-tales-mobile/blob/master/README.md\n[screens tour]: ?story=tour.json\n")}});t.appendChild(e),l.show([e.querySelector(".text"),e.querySelector("form")])};var D={};function T(t){return t<10?"0"+t:t}D.create=function(t,e,n,i){var r=[];n.time&&r.push({".name":"Time:",".value":function(t){var e=[],n=Math.floor(t/36e5);t-=36e5*n;var i=Math.floor(t/6e4);t-=6e4*i;var r=Math.floor(t/1e3);return e.push(n,T(i),T(r)),e.join(":")}(n.time)}),"number"==typeof n.points&&r.push({".name":"Points:",".value":String(n.points)});var o=h('<div class="screen">\n  <div class="text"></div>\n  <div class="results">\n    <ul>\n      <li class="result">\n        <span class="name">&nbsp;</span>\n        <span class="value">&nbsp;</span>\n      </li>\n    </ul>\n  </div>\n  <div class="footer">\n    <button class="close">Close</button>\n  </div>\n</div>\n',{".text":{_html:w(e||"## Congratulations!\n\nYou reached the end of this story.")},".result":r});t.appendChild(o);var s=o.querySelector(".footer"),a=[o.querySelector(".text"),o.querySelector(".results"),s];s.querySelector(".close").onclick=function(){l.hide(a,i)},l.show(a)};var R={};R.create=function(t,e,n,i){var r=h('<div class="screen">\n  <div class="text"></div>\n  <form action="#" onsubmit="return false;">\n    <input name="answer" autocomplete="off"/>\n  </form>\n  <div class="footer">\n    <button class="next">&#8594;</button>\n  </div>\n</div>\n',{".text":{_html:w(e)}}),s=r.querySelector(".text"),a=r.querySelector("form"),c=r.querySelector(".footer"),u=a.querySelector("input[name=answer]");u.type="number"==typeof n.answer?"number":"text",c.style.display="none";var d=[s,a],p=String(n.answer).toLowerCase();function f(){d.push(c),l.hide(d,i)}var g=!1;u.onchange=function(){g||(u.value.trim().toLowerCase()===p?(u.blur(),u.classList.remove("incorrect"),u.classList.add("correct"),g=!0,c.style.display="block",o(u,"tada",{delay:".5s"}),o(c,"bounceInUp",{delay:"1s"}),c.querySelector(".next").onclick=f):(u.classList.add("incorrect"),o(u,"shake",{duration:".7s"})))},u.onkeydown=function(){u.classList.remove("incorrect")},t.appendChild(r),l.show(d)};var I={};function P(t){var e=Math.min(Math.floor(3*t*255),255).toString(16);return 1===e.length?"0"+e:e}I.create=function(t,e,n,i){var r=n.map(function(t,e){return{".label":{_html:w(t.text).trim().replace(/^<p>|<\/p>$/g,"")},input:{value:String(e)}}}),s=h('<div class="screen">\n  <div class="text"></div>\n  <form action="#">\n    <ul>\n      <li class="choice">\n        <label>\n          <input type="radio" name="choice">\n          <span class="label">&nbsp;</span>\n        </label>\n      </li>\n    </ul>\n  </form>\n  <div class="footer">\n    <button class="next">&#8594;</button>\n  </div>\n</div>\n',{".text":{_html:w(e)},".choice":r}),a=s.querySelector(".text"),c=s.querySelector("form"),u=s.querySelector(".footer");u.style.display="none";var d=[a,c];function p(){var t=c.querySelector("input[name=choice]:checked");t&&(d.push(u),l.hide(d,function(){i(n[t.value])}))}var f=!1;Array.prototype.slice.call(c.querySelectorAll("input")).forEach(function(t){t.onchange=function(){f||(f=!0,u.style.display="block",o(u,"bounceInUp"),u.querySelector(".next").onclick=p)}}),t.appendChild(s),l.show(d)};var O={create:function(t,e,n,i){var r=document.createElement("div");return r.innerHTML=e,r.classList.add("message",n),t.appendChild(r),o(r,"bounceInDown",function(){r.classList.add("animated","infinite","pulse"),i&&i()}),{destroy:function(e){r.classList.remove("animated","infinite","pulse"),o(r,"bounceOutUp",function(){t.removeChild(r),e&&e()})}}}},q={},j=Object.create||function(t){var e=function(){};return e.prototype=t,new e},N=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return n},$=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};function F(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=j(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}q=F,F.EventEmitter=F,F.prototype._events=void 0,F.prototype._maxListeners=void 0;var z,H=10;try{var U={};Object.defineProperty&&Object.defineProperty(U,"x",{value:0}),z=0===U.x}catch(t){z=!1}function W(t){return void 0===t._maxListeners?F.defaultMaxListeners:t._maxListeners}function K(t,e,n,i){var r,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=t._events)?(o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]):(o=t._events=j(null),t._eventsCount=0),s){if("function"==typeof s?s=o[e]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),!s.warned&&(r=W(t))&&r>0&&s.length>r){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",a.name,a.message)}}else s=o[e]=n,++t._eventsCount;return t}function Z(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function B(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=$.call(Z,i);return r.listener=n,i.wrapFn=r,r}function G(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function X(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}z?Object.defineProperty(F,"defaultMaxListeners",{enumerable:!0,get:function(){return H},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');H=t}}):F.defaultMaxListeners=H,F.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},F.prototype.getMaxListeners=function(){return W(this)},F.prototype.emit=function(t){var e,n,i,r,o,s,a="error"===t;if(s=this._events)a=a&&null==s.error;else if(!a)return!1;if(a){if(arguments.length>1&&(e=arguments[1]),e instanceof Error)throw e;var l=new Error('Unhandled "error" event. ('+e+")");throw l.context=e,l}if(!(n=s[t]))return!1;var c="function"==typeof n;switch(i=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var i=t.length,r=X(t,i),o=0;o<i;++o)r[o].call(n)}(n,c,this);break;case 2:!function(t,e,n,i){if(e)t.call(n,i);else for(var r=t.length,o=X(t,r),s=0;s<r;++s)o[s].call(n,i)}(n,c,this,arguments[1]);break;case 3:!function(t,e,n,i,r){if(e)t.call(n,i,r);else for(var o=t.length,s=X(t,o),a=0;a<o;++a)s[a].call(n,i,r)}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,i,r,o){if(e)t.call(n,i,r,o);else for(var s=t.length,a=X(t,s),l=0;l<s;++l)a[l].call(n,i,r,o)}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(i-1),o=1;o<i;o++)r[o-1]=arguments[o];!function(t,e,n,i){if(e)t.apply(n,i);else for(var r=t.length,o=X(t,r),s=0;s<r;++s)o[s].apply(n,i)}(n,c,this,r)}return!0},F.prototype.addListener=function(t,e){return K(this,t,e,!1)},F.prototype.on=F.prototype.addListener,F.prototype.prependListener=function(t,e){return K(this,t,e,!0)},F.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,B(this,t,e)),this},F.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,B(this,t,e)),this},F.prototype.removeListener=function(t,e){var n,i,r,o,s;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=j(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(t,e){for(var n=r,i=n+1,o=t.length;i<o;n+=1,i+=1)t[n]=t[i];t.pop()}(n),1===n.length&&(i[t]=n[0]),i.removeListener&&this.emit("removeListener",t,s||e)}return this},F.prototype.removeAllListeners=function(t){var e,n,i;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=j(null),this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=j(null):delete n[t]),this;if(0===arguments.length){var r,o=N(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=j(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},F.prototype.listeners=function(t){var e,n=this._events;return n&&(e=n[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):[]},F.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):G.call(t,e)},F.prototype.listenerCount=G,F.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var J={};(function(t){"use strict";var e={1:"Position tracking not allowed",2:"Position tracking unavailable",3:"Position tracking timeout",DEFAULT:"Position tracking error"};J.create=function(){var n=new q.EventEmitter,i=navigator.geolocation.watchPosition(function(t){n.emit("position",{latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy})},function(t){var i=new Error(e[t.code]||e.DEFAULT);i.code=t.code,n.emit("error",i)},{enableHighAccuracy:!0,maximumAge:0}),r=void 0,o=null;function s(t){var e=void 0;if(void 0!==t.webkitCompassHeading){if("number"!=typeof(e=t.webkitCompassHeading))return;e=Math.floor(e)}else{if(!t.absolute){o();var i=new Error("Orientation tracking not absolute");return i.code="E_RELATIVE",void n.emit("error",i)}if("number"!=typeof t.alpha)return;e=360-Math.floor(t.alpha)}e!==r&&(r=e,n.emit("heading",e))}return o=function(){t.removeEventListener("deviceorientation",s),t.removeEventListener("deviceorientationabsolute",s)},"ondeviceorientationabsolute"in window?t.addEventListener("deviceorientationabsolute",s,!1):t.addEventListener("deviceorientation",s,!1),n.destroy=function(){o(),n.removeAllListeners(),navigator.geolocation.clearWatch(i)},n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var V={};V.create=function(t,e,n,i){var r=h('<div class="screen">\n  <div class="compass">\n    <div class="arrow">&#10143;</div>\n  </div>\n  <div class="distance"></div>\n  <div class="accuracy"></div>\n  <div class="footer">\n    <button class="next">&#8594;</button>\n  </div>\n</div>\n',{}),s=r.querySelector(".compass"),a=r.querySelector(".arrow"),c=r.querySelector(".accuracy"),u=r.querySelector(".distance"),d=r.querySelector(".footer");d.style.display="none",!1===n.compass&&(s.style.display="none"),t.appendChild(r);var p=e.center.latitude,f=e.center.longitude,g=void 0,m=void 0,v=void 0,y=void 0,b=void 0,x=void 0,w=void 0,k=!1,L=!1;function M(){b&&(b.destroy(),b=null)}function _(){g=y.latitude,m=y.longitude;var t=f-m,e=Math.cos(g)*Math.sin(p)-Math.sin(g)*Math.cos(p)*Math.cos(t),n=Math.sin(t)*Math.cos(p),i=180*Math.atan2(e,n)/Math.PI-v+180;i<0&&(i+=360);var r="rotate("+Math.round(i)+"deg)";a.style.transform=r,a.style.webkitTransform=r,k||(k=!0,L=!0,a.style.visibility="visible",o(a,"zoomIn",function(){L=!1,_()}))}n.demo?(x=new q.EventEmitter).destroy=function(){x.removeAllListeners()}:(x=J.create(),w=setTimeout(function(){b||(M(),b=O.create(t,"Waiting for position data","info"))},3e3));var S,E,C=n.colorSteps?(S=n.colorSteps,E=void 0,function(t){E||(E=t);var e=(t-t%S)/E;return"#"+(e>1?e>1.33?"0000ff":"00"+P(1.33-e)+"ff":e<=.33?"ff"+P(e)+"00":e<=.66?P(.66-e)+"ff00":"00ff"+P(e-.66))}):null;function A(){var t=y.accuracy,e=t<20?"":"Accuracy: ";c.innerHTML=e+Math.round(t||1e4)+" m"}if(x.on("error",function(e){clearTimeout(w),M(),b=O.create(t,e.message,"warning"),k=!1,a.style.visibility="hidden",document.documentElement.style.backgroundColor="inherit"}),x.on("position",function(r){if(clearTimeout(w),M(),y=r,!L){var o=e.distance(r);!1!==n.distance&&(u.innerHTML=o+" m",A()),void 0!==v&&_();var a=r.accuracy&&r.accuracy<20;if(a?c.classList.contains("bad")&&(c.classList.remove("bad"),!1===n.distance&&(c.innerHTML="")):(c.classList.add("bad"),!1===n.distance&&A()),C&&(document.documentElement.style.backgroundColor=a?C(o):"inherit"),a&&e.within(r)){b&&(b.destroy(),b=null),x.destroy();var h=[];!1!==n.compass&&h.push(s),!1!==n.distance&&h.push(u,c),l.hide(h,function(){s.style.display="none",u.style.display="none",c.style.display="none"}),d.style.display="block",l.show([d]),setTimeout(function(){var e=O.create(t,"Location reached!","info",function(){d.querySelector(".next").onclick=function(){l.hide([d],function(){d.style.display="none"}),e.destroy(function(){document.documentElement.style.backgroundColor="inherit",i()})}})},500)}}}),!1!==n.compass&&x.on("heading",function(t){t&&(v=t,y&&!L&&_())}),n.demo){var D={latitude:e.center.latitude-5e-4,longitude:e.center.longitude,accuracy:5},T=360;x.emit("heading",T),x.emit("position",D);var R=function(){setTimeout(function(){x.emit("heading",T),T-=3,x.emit("position",D),D.latitude+=2e-5,D.latitude<e.center.latitude&&R()},50)};setTimeout(R,1e3)}};var Y={},Q=void 0;function tt(){Q&&(Q.destroy(),Q=null)}Y.create=function(t,e,n){var i=!1,r=J.create(t),o=setTimeout(function(){Q||(tt(),Q=O.create(t,"Waiting for position data","info"))},3e3);r.on("error",function(e){clearTimeout(o),tt(),Q=O.create(t,e.message,"warning")}),r.on("position",function(s){clearTimeout(o),tt(),s.accuracy<20&&e.within(s)?(r.destroy(),i&&(t.innerHTML="",window.scrollTo(0,0)),n()):i||(i=!0,function(t,e,n,i){var r=h('<div class="screen">\n  <div class="text"></div>\n  <div class="footer">\n    <button class="next">Go!</button>\n  </div>\n</div>\n',{".text":{_html:w("## Go to start location\n\n- Latitude: `"+e.center.latitude+"`\n- Longitude: `"+e.center.longitude+"`")}}),o=r.querySelector(".footer"),s=[r.querySelector(".text"),o];o.querySelector(".next").onclick=function(){n.destroy(),tt(),l.hide(s,function(){t.innerHTML="",window.scrollTo(0,0),V.create(t,e,{},i)})},t.appendChild(r),l.show(s)}(t,e,r,n))})};var et={};function nt(t,e){throw new Error('Screen "'+t+'" '+e)}function it(t,e,n){e[n]||nt(t,"has no "+n)}function rt(t,e,n){t[n]||nt(e,'has unknown next "'+n+'"')}et.fromJson=function(t){if(!t.locations)throw new Error("No locations");if(!t.screens)throw new Error("No screens");if(!t.locations.start)throw new Error('Missing "start" location');if(!t.screens.start)throw new Error('Missing "start" screen');var e={};function n(n,i){localStorage.getItem("startTime")||localStorage.setItem("startTime",String((new Date).getTime())),function t(e,n,i,r,o){localStorage.setItem("screen",n);var s=e[n];switch(s.type){case"text":k.create(i,s.text,function(){i.innerHTML="",window.scrollTo(0,0),t(e,s.next,i,r,o)});break;case"input":R.create(i,s.text,{answer:s.answer},function(){i.innerHTML="",window.scrollTo(0,0),t(e,s.next,i,r,o)});break;case"choices":I.create(i,s.text,s.choices,function(n){if(i.innerHTML="",window.scrollTo(0,0),n.hasOwnProperty("points")){var a=localStorage.getItem("points");a=a?parseInt(a,10):0,localStorage.setItem("points",String(a+n.points))}t(e,n.next||s.next,i,r,o)});break;case"navigate":var a=r[s.location],l=s.options||{};o.demo&&(l.demo=!0),V.create(i,a,l,function(){i.innerHTML="",window.scrollTo(0,0),t(e,s.next,i,r,o)});break;case"finish":var c=parseInt(localStorage.getItem("startTime"),10),u={time:(new Date).getTime()-c},h=localStorage.getItem("points");h&&(u.points=parseInt(h,10)),D.create(i,s.text,u,function(){i.innerHTML="",window.scrollTo(0,0),A.create(i)}),localStorage.clear()}}(t.screens,i||"start",n,e,{demo:t.demo})}return Object.keys(t.locations).forEach(function(n){e[n]=_.fromJson(t.locations[n])}),function(t,e){var n=!1,i=Object.keys(e),r=Object.keys(t);function o(t){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}if(i.splice(i.indexOf("start"),1),o("start"),Object.keys(t).filter(function(r){var s=t[r];switch(it(r,s,"type"),s.type){case"text":it(r,s,"text"),it(r,s,"next"),rt(t,r,s.next),o(s.next);break;case"input":it(r,s,"text"),it(r,s,"answer"),it(r,s,"next"),rt(t,r,s.next),o(s.next);break;case"choices":it(r,s,"text"),it(r,s,"choices"),s.next&&(rt(t,r,s.next),o(s.next)),s.choices.forEach(function(e){e.text||nt(r,"has choice without text"),s.next||e.next||nt(r,"has choice without next"),e.next&&!t[e.next]&&nt(r,'has choice with unknown next "'+e.next+'"'),e.next&&o(e.next)});break;case"navigate":it(r,s,"location"),e[s.location]||nt(r,'has unknown location "'+s.location+'"');var a=i.indexOf(s.location);-1!==a&&i.splice(a,1),it(r,s,"next"),rt(t,r,s.next),o(s.next);break;case"finish":n=!0;break;default:nt(r,'has unknown type "'+s.type+'"')}}),i.length)throw new Error('Location "'+i[0]+'" is not used');if(r.length)throw new Error('Screen "'+r[0]+'" is not used');if(!n)throw new Error('Missing "finish" screen')}(t.screens,e),function(i){var r=localStorage.getItem("screen");t.demo||r?n(i,r):Y.create(i,e.start,function(){i.innerHTML="",window.scrollTo(0,0),n(i)})}};var ot={};function st(t,e){return Object.prototype.hasOwnProperty.call(t,e)}ot.create=function(t){function e(e){t.innerHTML="";var n=new XMLHttpRequest;n.onload=function(){if(200===this.status)try{et.fromJson(JSON.parse(this.responseText))(t),"tour.json"!==e&&localStorage.setItem("story",e)}catch(n){k.create(t,"## Failed to load story!\n\n"+e+"\n\n```"+n.toString()+"\n```")}else k.create(t,"## "+this.status+"\n\n"+e)},n.open("get",e,!0),n.send()}return{load:function(n){function i(){localStorage.clear(),e(n)}var r=localStorage.getItem("story");r&&localStorage.getItem("screen")?x.create(t,function(){e(r)},i):i()}}};var at=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};Array.isArray;Object.keys;var lt={parse:function(t,e,n,i){e=e||"&",n=n||"=";var r={};if("string"!=typeof t||0===t.length)return r;var o=/\+/g;t=t.split(e);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var a=t.length;s>0&&a>s&&(a=s);for(var l=0;l<a;++l){var c,u,h,d,p=t[l].replace(o,"%20"),f=p.indexOf(n);f>=0?(c=p.substr(0,f),u=p.substr(f+1)):(c=p,u=""),h=decodeURIComponent(c),d=decodeURIComponent(u),st(r,h)?at(r[h])?r[h].push(d):r[h]=[r[h],d]:r[h]=d}return r}};document.addEventListener("DOMContentLoaded",function(){var t=document.body.querySelector("#content"),e=lt.parse(location.search.substring(1));e.story?ot.create(t).load(e.story):A.create(t)});var ct=location.protocol+"//"+location.host;document.addEventListener("click",function(t){for(var e=t.target;e&&"A"!==e.nodeName;)e=e.parentNode;e&&e.href&&0===e.href.indexOf(ct)&&(t.preventDefault(),location.href=t.target.href)},!1)}();
//# sourceMappingURL=bundle-0.0.13.js.map